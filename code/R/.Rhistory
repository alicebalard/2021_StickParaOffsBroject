geom_violin() +
geom_boxplot(aes(fill = trtG1G2), width = 0.2) +
geom_jitter(width = .1, size = 1, pch = 21, fill = "white") +
scale_fill_manual(values = colOffs) +
theme_bw()  + theme(legend.position = "none")
modFull <- lmer(res_Nbr_methCpG_Nbr_coveredCpG ~ trtG1G2 * Sex + (1|Family),
data = fullMetadata_OFFS_half, REML = F) # REML =F for model comparison
mod_noSex <- lmer(res_Nbr_methCpG_Nbr_coveredCpG ~ trtG1G2 + (1|Family),
data = fullMetadata_OFFS_half, REML = F)
mod_noTrt <- lmer(res_Nbr_methCpG_Nbr_coveredCpG ~ Sex + (1|Family),
data = fullMetadata_OFFS_half, REML = F)
mod_noInteractions <- lmer(res_Nbr_methCpG_Nbr_coveredCpG ~ trtG1G2 + Sex + (1|Family),
data = fullMetadata_OFFS_half, REML = F)
lrtest(modFull, mod_noSex) # sex is significant p = 0.0015 **
lrtest(modFull, mod_noTrt) # trt is not significant any longer
lrtest(modFull, mod_noInteractions) # interactions are are not significant any longer
ggplot(fullMetadata_OFFS_half, aes(trtG1G2, res_Nbr_methCpG_Nbr_coveredCpG,
group=interaction(trtG1G2, Sex))) +
facet_grid(~Sex) +
geom_violin() +
geom_boxplot(aes(fill = trtG1G2), width = 0.2) +
geom_jitter(width = .1, size = 1, pch = 21, fill = "white") +
scale_fill_manual(values = colOffs) +
theme_bw() + theme(legend.position = "none")
mod1 <- lmer(res_Nbr_methCpG_Nbr_coveredCpG ~ trtG1G2 + (1|Family),
data = fullMetadata_PAR_half, REML = F)
mod0 <- lmer(res_Nbr_methCpG_Nbr_coveredCpG ~ 1 + (1|Family),
data = fullMetadata_PAR_half, REML = F)
lrtest(mod1, mod0) # not significant in parents
mod1 <- lmer(res_Nbr_methCpG_Nbr_coveredCpG ~ trtG1G2 + (1|Family) + (1|Sex),
data = fullMetadata_OFFS_half, REML = F)
mod0 <- lmer(res_Nbr_methCpG_Nbr_coveredCpG ~ 1 + (1|Family) + (1|Sex),
data = fullMetadata_OFFS_half, REML = F)
lrtest(mod1, mod0) # not significant in offspring
modFull <- lmer(res_Nbr_methCpG_Nbr_coveredCpG ~ patTrt * outcome + (1|Family) + (1|Sex),
data = fullMetadata_OFFS_half, REML = F)
mod_noPAT <- lmer(res_Nbr_methCpG_Nbr_coveredCpG ~ outcome + (1|Family) + (1|Sex),
data = fullMetadata_OFFS_half, REML = F)
mod_noOFF <- lmer(res_Nbr_methCpG_Nbr_coveredCpG ~ patTrt + (1|Family) + (1|Sex),
data = fullMetadata_OFFS_half, REML = F)
mod_noInt <- lmer(res_Nbr_methCpG_Nbr_coveredCpG ~ patTrt + outcome + (1|Family) + (1|Sex),
data = fullMetadata_OFFS_half, REML = F)
lrtest(modFull, mod_noPAT) # not significant
lrtest(modFull, mod_noOFF) # not significant
lrtest(modFull, mod_noInt) # not significant
modFull <- lmer(res_Nbr_methCpG_Nbr_coveredCpG ~ BCI * No.Worms + (1|Family) + (1|Sex),
data = fullMetadata_OFFS_half, REML = F)
mod_noBCI <- lmer(res_Nbr_methCpG_Nbr_coveredCpG ~ No.Worms + (1|Family) + (1|Sex),
data = fullMetadata_OFFS_half, REML = F)
mod_noNo.Worms <- lmer(res_Nbr_methCpG_Nbr_coveredCpG ~ BCI + (1|Family) + (1|Sex),
data = fullMetadata_OFFS_half, REML = F)
mod_noInt <- lmer(res_Nbr_methCpG_Nbr_coveredCpG ~ BCI + No.Worms + (1|Family) + (1|Sex),
data = fullMetadata_OFFS_half, REML = F)
lrtest(modFull, mod_noBCI) # significant p = 0.025 *
lrtest(modFull, mod_noNo.Worms) # not significant
lrtest(modFull, mod_noInt) # not significant
mod1 <- lmer(res_Nbr_methCpG_Nbr_coveredCpG ~ BCI + (1|Family),
data = fullMetadata_PAR_half, REML = F)
mod0 <- lmer(res_Nbr_methCpG_Nbr_coveredCpG ~ 1 + (1|Family),
data = fullMetadata_PAR_half, REML = F)
lrtest(mod1, mod0) # not significant in parents
mod1 <- lmer(res_Nbr_methCpG_Nbr_coveredCpG ~ BCI + (1|Family) + (1|Sex),
data = fullMetadata_OFFS_half, REML = F)
mod0 <- lmer(res_Nbr_methCpG_Nbr_coveredCpG ~ 1 + (1|Family)+ (1|Sex),
data = fullMetadata_OFFS_half, REML = F)
lrtest(mod1, mod0) # VERY significant in offspring p = 0.0057 **
pred <- ggpredict(mod1, terms = c("BCI", "Sex", "Family"), type = "random")
plot(pred, ci = F, add.data = TRUE)
mod1 <- lmer(BCI ~ res_Nbr_methCpG_Nbr_coveredCpG + (1|Family) + (1|Sex),
data = fullMetadata_OFFS_half, REML = F)
mod0 <- lmer(1 ~ res_Nbr_methCpG_Nbr_coveredCpG + (1|Family)+ (1|Sex),
data = fullMetadata_OFFS_half, REML = F)
mod0 <- lmer(BCI ~ 1 + (1|Family)+ (1|Sex),
data = fullMetadata_OFFS_half, REML = F)
lrtest(mod1, mod0) # VERY significant in offspring p = 0.0057 **
ggplot(fullMetadata_OFFS_half,
aes(x=res_Nbr_methCpG_Nbr_coveredCpG, y=BCI)) +
geom_point()
ggplot(fullMetadata_OFFS_half,
aes(x=res_Nbr_methCpG_Nbr_coveredCpG, y=BCI)) +
geom_point() +
theme_bw()
ggplot(fullMetadata_OFFS_half,
aes(x=res_Nbr_methCpG_Nbr_coveredCpG, y=BCI)) +
geom_smooth(method = "lm") +
geom_point() +
theme_bw()
ggplot(fullMetadata_OFFS_half,
aes(x=res_Nbr_methCpG_Nbr_coveredCpG, y=BCI)) +
geom_smooth(method = "lm", col = "grey") +
geom_point() +
theme_bw()
ggplot(fullMetadata_OFFS_half,
aes(x=res_Nbr_methCpG_Nbr_coveredCpG, y=BCI)) +
geom_smooth(method = "lm", col = "darkgrey") +
geom_point() +
theme_bw()
ggplot(fullMetadata_OFFS_half,
aes(x=res_Nbr_methCpG_Nbr_coveredCpG, y=BCI)) +
geom_smooth(method = "lm", col = "darkgrey") +
geom_point(pch=21, aes(fill=trtG1G2)) +
scale_color_manual(values = colOffs) +
theme_bw()
ggplot(fullMetadata_OFFS_half,
aes(x=res_Nbr_methCpG_Nbr_coveredCpG, y=BCI)) +
geom_smooth(method = "lm", col = "darkgrey") +
geom_point(pch=21, aes(fill=trtG1G2)) +
scale_fill_manual(values = colOffs) +
theme_bw() + theme(legend.position = "top")
ggplot(fullMetadata_OFFS_half,
aes(x=res_Nbr_methCpG_Nbr_coveredCpG, y=BCI)) +
geom_smooth(method = "lm", col = "darkgrey") +
geom_point(pch=21, aes(fill=trtG1G2), size =3, alpha = .8) +
scale_fill_manual(values = colOffs) +
theme_bw() + theme(legend.position = "top")
ggplot(fullMetadata_OFFS_half,
aes(x=res_Nbr_methCpG_Nbr_coveredCpG, y=BCI)) +
geom_smooth(method = "lm", col = "darkgrey") +
geom_point(pch=21, aes(fill=trtG1G2), size =3, alpha = .8) +
scale_fill_manual(values = colOffs) +
stat_density_2d(aes(alpha = ..trtG1G2..)) +
theme_bw() + theme(legend.position = "top")
ggplot(fullMetadata_OFFS_half,
aes(x=res_Nbr_methCpG_Nbr_coveredCpG, y=BCI)) +
stat_density_2d(aes(alpha = ..trtG1G2..))
ggplot(fullMetadata_OFFS_half,
aes(x=res_Nbr_methCpG_Nbr_coveredCpG, y=BCI)) +
stat_density_2d(aes(group = ..trtG1G2..))
ggplot(fullMetadata_OFFS_half,
aes(x=res_Nbr_methCpG_Nbr_coveredCpG, y=BCI)) +
stat_density_2d(aes(group = trtG1G2))
ggplot(fullMetadata_OFFS_half,
aes(x=res_Nbr_methCpG_Nbr_coveredCpG, y=BCI)) +
stat_density_2d(aes(col = trtG1G2))
ggplot(fullMetadata_OFFS_half,
aes(x=res_Nbr_methCpG_Nbr_coveredCpG, y=BCI)) +
stat_density_2d(aes(col = trtG1G2)) +
geom_smooth(method = "lm", col = "darkgrey") +
geom_point(pch=21, aes(fill=trtG1G2), size =3, alpha = .8) +
scale_fill_manual(values = colOffs) +
theme_bw() + theme(legend.position = "top")
ggplot(fullMetadata_OFFS_half,
aes(x=res_Nbr_methCpG_Nbr_coveredCpG, y=BCI)) +
stat_density_2d(aes(col = trtG1G2)) +
geom_smooth(method = "lm", col = "darkgrey") +
geom_point(pch=21, aes(fill=trtG1G2), size =3, alpha = .8) +
scale_fill_manual(values = colOffs) +
scale_col_manual(values = colOffs) +
theme_bw() + theme(legend.position = "top")
ggplot(fullMetadata_OFFS_half,
aes(x=res_Nbr_methCpG_Nbr_coveredCpG, y=BCI)) +
stat_density_2d(aes(col = trtG1G2)) +
geom_smooth(method = "lm", col = "darkgrey") +
geom_point(pch=21, aes(fill=trtG1G2), size =3, alpha = .8) +
scale_fill_manual(values = colOffs) +
scale_color_manual(values = colOffs) +
theme_bw() + theme(legend.position = "top")
library("cowplot")
scatterplot <- ggplot(fullMetadata_OFFS_half,
aes(x = res_Nbr_methCpG_Nbr_coveredCpG,
y = BCI, fill=trtG1G2)) +
geom_point(pch=21, size =3, alpha = .8) +
guides(color = FALSE) +
theme(plot.margin = margin())
scatterplot <- ggplot(fullMetadata_OFFS_half,
aes(x = res_Nbr_methCpG_Nbr_coveredCpG,
y = BCI, fill=trtG1G2)) +
geom_point(pch=21, size =3, alpha = .8) +
guides(color = "none") +
theme(plot.margin = margin())
scatterplot
scatterplot <- ggplot(fullMetadata_OFFS_half,
aes(x = res_Nbr_methCpG_Nbr_coveredCpG,
y = BCI, fill=trtG1G2)) +
geom_point(pch=21, size =3, alpha = .8) +
guides(color = "none") +
theme(plot.margin = margin())
marginal_distribution <- function(x, var, group) {
ggplot(x, aes_string(x = var, fill = group)) +
geom_histogram(bins = 30, alpha = 0.4, position = "identity") +
guides(fill = FALSE) +
theme_void() +
theme(plot.margin = margin())
}
x_hist <- marginal_distribution(fullMetadata_OFFS_half, "res_Nbr_methCpG_Nbr_coveredCpG", "trtG1G2")
ggplot(x, aes_string(x = var, fill = group)) +
geom_histogram(bins = 30, alpha = 0.4, position = "identity") +
guides(fill = "none") +
theme_void() +
theme(plot.margin = margin())
marginal_distribution <- function(x, var, group) {
ggplot(x, aes_string(x = var, fill = group)) +
geom_histogram(bins = 30, alpha = 0.4, position = "identity") +
guides(fill = "none") +
theme_void() +
theme(plot.margin = margin())
}
x_hist <- marginal_distribution(fullMetadata_OFFS_half, "res_Nbr_methCpG_Nbr_coveredCpG", "trtG1G2")
y_hist <- marginal_distribution(fullMetadata_OFFS_half, "BCI", "trtG1G2") +
coord_flip()
aligned_x_hist <- align_plots(x_hist, scatterplot, align = "v")[[1]]
aligned_y_hist <- align_plots(y_hist, scatterplot, align = "h")[[1]]
plot_grid(
aligned_x_hist
, NULL
, scatterplot
, aligned_y_hist
, ncol = 2
, nrow = 2
, rel_heights = c(0.2, 1)
, rel_widths = c(1, 0.2)
)
marginal_distribution <- function(x, var, group) {
ggplot(x, aes_string(x = var, fill = group)) +
geom_density(alpha = 0.4, size = 0.1) +
guides(fill = "none") +
theme_void() +
theme(plot.margin = margin())
}
x_hist <- marginal_distribution(fullMetadata_OFFS_half, "res_Nbr_methCpG_Nbr_coveredCpG", "trtG1G2")
y_hist <- marginal_distribution(fullMetadata_OFFS_half, "BCI", "trtG1G2") +
coord_flip()
aligned_x_hist <- align_plots(x_hist, scatterplot, align = "v")[[1]]
aligned_y_hist <- align_plots(y_hist, scatterplot, align = "h")[[1]]
plot_grid(
aligned_x_hist
, NULL
, scatterplot
, aligned_y_hist
, ncol = 2
, nrow = 2
, rel_heights = c(0.2, 1)
, rel_widths = c(1, 0.2)
)
scatterplot <- ggplot(fullMetadata_OFFS_half,
aes(x = res_Nbr_methCpG_Nbr_coveredCpG,
y = BCI, fill=trtG1G2)) +
geom_point(pch=21, size =3, alpha = .8) +
guides(color = "none") +
theme(plot.margin = margin()) +
theme(legend.position = "bottom")
marginal_distribution <- function(x, var, group) {
ggplot(x, aes_string(x = var, fill = group)) +
geom_density(alpha = 0.4, size = 0.1) +
guides(fill = "none") +
theme_void() +
theme(plot.margin = margin())
}
x_hist <- marginal_distribution(fullMetadata_OFFS_half, "res_Nbr_methCpG_Nbr_coveredCpG", "trtG1G2")
y_hist <- marginal_distribution(fullMetadata_OFFS_half, "BCI", "trtG1G2") +
coord_flip()
aligned_x_hist <- align_plots(x_hist, scatterplot, align = "v")[[1]]
aligned_y_hist <- align_plots(y_hist, scatterplot, align = "h")[[1]]
plot_grid(
aligned_x_hist
, NULL
, scatterplot
, aligned_y_hist
, ncol = 2
, nrow = 2
, rel_heights = c(0.2, 1)
, rel_widths = c(1, 0.2)
)
scatterplot <- ggplot(fullMetadata_OFFS_half,
aes(x = res_Nbr_methCpG_Nbr_coveredCpG,
y = BCI, fill=trtG1G2)) +
geom_point(pch=21, size =3, alpha = .8) +
guides(color = "none") +
theme(plot.margin = margin()) +
theme(legend.position = "left")
marginal_distribution <- function(x, var, group) {
ggplot(x, aes_string(x = var, fill = group)) +
geom_density(alpha = 0.4, size = 0.1) +
guides(fill = "none") +
theme_void() +
theme(plot.margin = margin())
}
x_hist <- marginal_distribution(fullMetadata_OFFS_half, "res_Nbr_methCpG_Nbr_coveredCpG", "trtG1G2")
y_hist <- marginal_distribution(fullMetadata_OFFS_half, "BCI", "trtG1G2") +
coord_flip()
aligned_x_hist <- align_plots(x_hist, scatterplot, align = "v")[[1]]
aligned_y_hist <- align_plots(y_hist, scatterplot, align = "h")[[1]]
plot_grid(
aligned_x_hist
, NULL
, scatterplot
, aligned_y_hist
, ncol = 2
, nrow = 2
, rel_heights = c(0.2, 1)
, rel_widths = c(1, 0.2)
)
scatterplot <- ggplot(fullMetadata_OFFS_half,
aes(x = res_Nbr_methCpG_Nbr_coveredCpG,
y = BCI, fill=trtG1G2)) +
geom_point(pch=21, size =3, alpha = .8) +
guides(color = "none") +
theme(plot.margin = margin()) +
theme(legend.position = "none")
marginal_distribution <- function(x, var, group) {
ggplot(x, aes_string(x = var, fill = group)) +
geom_density(alpha = 0.4, size = 0.1) +
guides(fill = "none") +
theme_void() +
theme(plot.margin = margin())
}
x_hist <- marginal_distribution(fullMetadata_OFFS_half, "res_Nbr_methCpG_Nbr_coveredCpG", "trtG1G2")
y_hist <- marginal_distribution(fullMetadata_OFFS_half, "BCI", "trtG1G2") +
coord_flip()
aligned_x_hist <- align_plots(x_hist, scatterplot, align = "v")[[1]]
aligned_y_hist <- align_plots(y_hist, scatterplot, align = "h")[[1]]
plot_grid(
aligned_x_hist
, NULL
, scatterplot
, aligned_y_hist
, ncol = 2
, nrow = 2
, rel_heights = c(0.2, 1)
, rel_widths = c(1, 0.2)
)
scatterplot <- ggplot(fullMetadata_OFFS_half,
aes(x = res_Nbr_methCpG_Nbr_coveredCpG,
y = BCI, fill=trtG1G2)) +
geom_point(pch=21, size =3, alpha = .8) +
guides(color = "none") +
scale_fill_manual(values = colOffs) +
theme(plot.margin = margin()) +
theme(legend.position = "none")
marginal_distribution <- function(x, var, group) {
ggplot(x, aes_string(x = var, fill = group)) +
geom_density(alpha = 0.4, size = 0.1) +
guides(fill = "none") +
theme_void() +
theme(plot.margin = margin())
}
x_hist <- marginal_distribution(fullMetadata_OFFS_half, "res_Nbr_methCpG_Nbr_coveredCpG", "trtG1G2")
y_hist <- marginal_distribution(fullMetadata_OFFS_half, "BCI", "trtG1G2") +
coord_flip()
aligned_x_hist <- align_plots(x_hist, scatterplot, align = "v")[[1]]
aligned_y_hist <- align_plots(y_hist, scatterplot, align = "h")[[1]]
plot_grid(
aligned_x_hist
, NULL
, scatterplot
, aligned_y_hist
, ncol = 2
, nrow = 2
, rel_heights = c(0.2, 1)
, rel_widths = c(1, 0.2)
)
ggplot(x, aes_string(x = var, fill = group)) +
geom_density(alpha = 0.4, size = 0.1) +
guides(fill = "none") +
scale_fill_manual(values = colOffs) +
theme_void() +
theme(plot.margin = margin())
marginal_distribution <- function(x, var, group) {
ggplot(x, aes_string(x = var, fill = group)) +
geom_density(alpha = 0.4, size = 0.1) +
guides(fill = "none") +
scale_fill_manual(values = colOffs) +
theme_void() +
theme(plot.margin = margin())
}
x_hist <- marginal_distribution(fullMetadata_OFFS_half, "res_Nbr_methCpG_Nbr_coveredCpG", "trtG1G2")
y_hist <- marginal_distribution(fullMetadata_OFFS_half, "BCI", "trtG1G2") +
coord_flip()
aligned_x_hist <- align_plots(x_hist, scatterplot, align = "v")[[1]]
aligned_y_hist <- align_plots(y_hist, scatterplot, align = "h")[[1]]
plot_grid(
aligned_x_hist
, NULL
, scatterplot
, aligned_y_hist
, ncol = 2
, nrow = 2
, rel_heights = c(0.2, 1)
, rel_widths = c(1, 0.2)
)
marginal_distribution <- function(x, var, group) {
ggplot(x, aes_string(x = var, fill = group)) +
geom_density(alpha = 0.6, size = 0.2) +
guides(fill = "none") +
scale_fill_manual(values = colOffs) +
theme_void() +
theme(plot.margin = margin())
}
x_hist <- marginal_distribution(fullMetadata_OFFS_half, "res_Nbr_methCpG_Nbr_coveredCpG", "trtG1G2")
y_hist <- marginal_distribution(fullMetadata_OFFS_half, "BCI", "trtG1G2") +
coord_flip()
aligned_x_hist <- align_plots(x_hist, scatterplot, align = "v")[[1]]
aligned_y_hist <- align_plots(y_hist, scatterplot, align = "h")[[1]]
plot_grid(
aligned_x_hist
, NULL
, scatterplot
, aligned_y_hist
, ncol = 2
, nrow = 2
, rel_heights = c(0.2, 1)
, rel_widths = c(1, 0.2)
)
mod1 <- lmer(BCI ~ res_Nbr_methCpG_Nbr_coveredCpG + (1|Family) + (1|Sex),
data = fullMetadata_OFFS_half, REML = F)
mod0 <- lmer(BCI ~ 1 + (1|Family)+ (1|Sex),
data = fullMetadata_OFFS_half, REML = F)
lrtest(mod1, mod0) # VERY significant in offspring p = 0.0057 **
pred <- ggpredict(mod1, terms = c("BCI", "Sex", "Family"), type = "random")
plot(pred, ci = F, add.data = TRUE)
pred <- ggpredict(mod1, terms = c("res_Nbr_methCpG_Nbr_coveredCpG", "Sex", "Family"), type = "random")
plot(pred, ci = F, add.data = TRUE)
source("librariesLoading.R")
source("customRfunctions.R")
source("R02.1_loadMetadata.R")
fullMetadata_OFFS$BCI <- residuals(lmer(Wnettofin ~ Slfin * Sex + (1|Family), data=fullMetadata_OFFS))
fullMetadata_PAR$BCI <- residuals(lmer(Wnettofin ~ Slfin + (1|Family), data=fullMetadata_PAR))
machine="mythinkpad"
source("R02.2_loadMethyldata.R")
base::load("../../gitignore/bigdata/05MethylKit/output/uniteCovALL_G2_woSexAndUnknownChr_10feb22.RData"))
base::load("../../gitignore/bigdata/05MethylKit/output/uniteCovALL_G2_woSexAndUnknownChr_10feb22.RData")
uniteCovALL_G2_woSexAndUnknowChr
nrow(uniteCovALL_G2_woSexAndUnknowChr)
warnings(
)
