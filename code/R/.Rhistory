dataG1$Idplate
dataG1$Idplate
dataG1$Idplate
dataAll$matchV48
as.character(dataG1$Idplate)
as.character(dataG1$Idplate) %in% dataAll$matchV48
as.character(dataG1$Idplate)
dataAll$matchV48
dataG1$Idplate
dataG1$FamilyOfFather
dataG1$clutch.ID
dataG1$Family
dataG1$HK.W
dataAll$HK.W
head(dataG1)
dataAll$HK.W
dataG1$HK.W/10
dataAll$HK.W
data.frame(Idplate = dataG1$Idplate,
FamilyOfFather = dataG1$FamilyOfFather,
clutch.ID = dataG1$clutch.ID,
HK.W = dataG1$HK.W/10)
data.frame(matchV48 = dataG1$Idplate,
merge(dataAll,
data.frame(matchV48 = dataG1$Idplate,
FamilyOfFather = dataG1$FamilyOfFather,
clutch.ID = dataG1$clutch.ID,
HK.W = dataG1$HK.W/10))
merge(dataAll,
data.frame(matchV48 = dataG1$Idplate,
FamilyOfFather = dataG1$FamilyOfFather,
clutch.ID = dataG1$clutch.ID,
HK.W = dataG1$HK.W/10))
merge(dataAll,
data.frame(matchV48 = dataG1$Idplate,
FamilyOfFather = dataG1$FamilyOfFather,
clutch.ID = dataG1$clutch.ID,
HK.W = dataG1$HK.W/10))
merge(data.frame(matchV48 = dataG1$Idplate,
FamilyOfFather = dataG1$FamilyOfFather,
clutch.ID = dataG1$clutch.ID,
HK.W = dataG1$HK.W/10),
dataAll)
merge(data.frame(matchV48 = dataG1$Idplate,
FamilyOfFather = dataG1$FamilyOfFather,
clutch.ID = dataG1$clutch.ID,
HK.W = dataG1$HK.W/10
No.Worms = dataG1$number.of.worms),
dataAll)
merge(data.frame(matchV48 = dataG1$Idplate,
FamilyOfFather = dataG1$FamilyOfFather,
clutch.ID = dataG1$clutch.ID,
HK.W = dataG1$HK.W/10,
No.Worms = dataG1$number.of.worms),
dataAll)
dataG1$number.of.worms
dataG1$number.of.worms[is.na(dataG1$number.of.worms)]
dataG1$number.of.worms[is.na(dataG1$number.of.worms)] <- 0
merge(data.frame(matchV48 = dataG1$Idplate,
FamilyOfFather = dataG1$FamilyOfFather,
clutch.ID = dataG1$clutch.ID,
HK.W = dataG1$HK.W/10,
No.Worms = dataG1$number.of.worms),
dataAll)
dataG1$W.net
dataAll$Wnettofin
merge(data.frame(matchV48 = dataG1$Idplate,
FamilyOfFather = dataG1$FamilyOfFather,
clutch.ID = dataG1$clutch.ID,
HK.W = dataG1$HK.W/10,
No.Worms = dataG1$number.of.worms,
Wnettofin = dataG1$W.net),
dataAll)
merge(data.frame(matchV48 = dataG1$Idplate,
FamilyOfFather = dataG1$FamilyOfFather,
clutch.ID = dataG1$clutch.ID,
HK.W = dataG1$HK.W/10,
No.Worms = dataG1$number.of.worms,
Wnettofin = dataG1$W.net),
dataAll)
dataG1$SL
dataAll$Slfin
merge(data.frame(matchV48 = dataG1$Idplate,
FamilyOfFather = dataG1$FamilyOfFather,
clutch.ID = dataG1$clutch.ID,
HK.W = dataG1$HK.W/10,
No.Worms = dataG1$number.of.worms,
Wnettofin = dataG1$W.net,
Slfin = dataG1$SL),
dataAll)
ParentsDF <- merge(data.frame(matchV48 = dataG1$Idplate,
FamilyOfFather = dataG1$FamilyOfFather,
clutch.ID = dataG1$clutch.ID,
HK.W = dataG1$HK.W/10,
No.Worms = dataG1$number.of.worms,
Wnettofin = dataG1$W.net,
Slfin = dataG1$SL),
dataAll)
key
merge(key, dataAll)
nrow(merge(key, dataAll))
nrow(dataAll)
nrow(merge(key, dataAll)) + nrow(ParentsDF)
merge(key, dataAll)
head(ParentsDF)
head(ParentsDF)
ParentsDF$clutch.ID
table(ParentsDF$clutch.ID)
ParentsDF$ID
data.frame(FamilyOfOffspring = ParentsDF$clutch.ID,
fatherID = ParentsDF$ID)
merge(key, dataAll)
OffspringDF <- merge(key, dataAll)
cleanDF <- merge(data.frame(matchV48 = dataG1$Idplate,
FamilyOfFather = dataG1$FamilyOfFather,
clutch.ID = dataG1$clutch.ID,
HK.W = dataG1$HK.W/10,
No.Worms = dataG1$number.of.worms,
Wnettofin = dataG1$W.net,
Slfin = dataG1$SL),
dataAll,
all = TRUE)
View(cleanDF)
data.frame(clutch.ID = ParentsDF$clutch.ID,
fatherID = ParentsDF$ID)
View(cleanDF)
merge(key, cleanDF)
key
cleanDF$matchV48
as.character(key$matchV48)
key
key$clutch.ID
cleanDF$clutch.ID
data.frame(matchV48 = as.character(key$matchV48),
clutch.ID = key$clutch.ID)
merge(data.frame(matchV48 = as.character(key$matchV48),
clutch.ID = key$clutch.ID),
cleanDF)
data.frame(matchV48 = as.character(key$matchV48),
clutch.ID.2 = key$clutch.ID)
merge(data.frame(matchV48 = as.character(key$matchV48),
clutch.ID.G2 = key$clutch.ID),
cleanDF)
nrow(merge(data.frame(matchV48 = as.character(key$matchV48),
clutch.ID.G2 = key$clutch.ID),
cleanDF))
nrow(merge(data.frame(matchV48 = as.character(key$matchV48),
clutch.ID.G2 = key$clutch.ID),
cleanDF,
all=TRUE))
cleanDF <- merge(data.frame(matchV48 = as.character(key$matchV48),
clutch.ID.G2 = key$clutch.ID),
cleanDF,
all=TRUE)
View(cleanDF)
cleanDF$clutch.ID + cleanDF$clutch.ID.G2
c(cleanDF$clutch.ID, cleanDF$clutch.ID.G2)
paste(cleanDF$clutch.ID, cleanDF$clutch.ID.G2)
paste0(cleanDF$clutch.ID, cleanDF$clutch.ID.G2)
gsub("NA", paste0(cleanDF$clutch.ID, cleanDF$clutch.ID.G2))
gsub("NA", "", paste0(cleanDF$clutch.ID, cleanDF$clutch.ID.G2))
cleanDF$clutch.ID <- gsub("NA", "", paste0(cleanDF$clutch.ID, cleanDF$clutch.ID.G2))
View(cleanDF)
cleanDF$ID
data.frame(cleanDF$FamilyOfFather,
cleanDF$clutch.ID,
cleanDF$ID)
na.omit(data.frame(cleanDF$FamilyOfFather,
cleanDF$clutch.ID,
cleanDF$ID))
na.omit(data.frame(FamilyOfFather = cleanDF$FamilyOfFather,
clutch.ID = cleanDF$clutch.ID,
fatherID = cleanDF$ID))
merge(cleanDF,
na.omit(data.frame(FamilyOfFather = cleanDF$FamilyOfFather,
clutch.ID = cleanDF$clutch.ID,
fatherID = cleanDF$ID)))
merge(cleanDF,
na.omit(data.frame(FamilyOfFather = cleanDF$FamilyOfFather,
clutch.ID = cleanDF$clutch.ID,
fatherID = cleanDF$ID)),
all = TRU)
merge(cleanDF,
na.omit(data.frame(FamilyOfFather = cleanDF$FamilyOfFather,
clutch.ID = cleanDF$clutch.ID,
fatherID = cleanDF$ID)),
all = TRUe)
merge(cleanDF,
na.omit(data.frame(FamilyOfFather = cleanDF$FamilyOfFather,
clutch.ID = cleanDF$clutch.ID,
fatherID = cleanDF$ID)),
all = TRUE)
nrow(merge(cleanDF,
na.omit(data.frame(FamilyOfFather = cleanDF$FamilyOfFather,
clutch.ID = cleanDF$clutch.ID,
fatherID = cleanDF$ID)),
all = TRUE))
cleanDF <- merge(cleanDF,
na.omit(data.frame(FamilyOfFather = cleanDF$FamilyOfFather,
clutch.ID = cleanDF$clutch.ID,
fatherID = cleanDF$ID)),
all = TRUE)
View(cleanDF)
dataG1 <- read.csv("../../data/raw data Joshka Kostas/data-G1-Kostas_JK.csv")
dataAll <- read.csv("../../data/raw data Joshka Kostas/Kostas_G2_info.csv")
key <- read.csv("../../data/raw data Joshka Kostas/key_matchV48_clutchID_G2_Alice.csv")
as.character(dataG1$Idplate) %in% dataAll$matchV48
as.character(dataG1$Idplate)
dataAll$matchV48
dataG1$number.of.worms[is.na(dataG1$number.of.worms)] <- 0
cleanDF <- merge(data.frame(matchV48 = dataG1$Idplate,
FamilyOfFather = dataG1$FamilyOfFather,
clutch.ID = dataG1$clutch.ID,
HK.W = dataG1$HK.W/10,
No.Worms = dataG1$number.of.worms,
Wnettofin = dataG1$W.net,
Slfin = dataG1$SL),
dataAll,
all = TRUE)
cleanDF <- merge(data.frame(matchV48 = as.character(key$matchV48),
clutch.ID.G2 = key$clutch.ID),
cleanDF,
all=TRUE)
cleanDF$clutch.ID <- gsub("NA", "", paste0(cleanDF$clutch.ID, cleanDF$clutch.ID.G2))
cleanDF <- merge(na.omit(data.frame(FamilyOfFather = cleanDF$FamilyOfFather,
clutch.ID = cleanDF$clutch.ID,
fatherID = cleanDF$ID)),
cleanDF,
all = TRUE)
View(cleanDF)
is.na(cleanDF$fatherID) & cleanDF$Generat %in% "P"
which(is.na(cleanDF$fatherID) & cleanDF$Generat %in% "P")
is.na(cleanDF$fatherID)
cleanDF$Generat
which(is.na(cleanDF$fatherID) & cleanDF$Generat %in% "NA")
cleanDF$Generat %in% "NA"
which(is.na(cleanDF$Generat))# & cleanDF$Generat %in% "NA")
cleanDF <- cleanDF[!is.na(cleanDF$Generat),]
View(cleanDF)
cleanDF[names(cleanDF) %in% "clutchIDG2"]
names(cleanDF) %in% "clutchIDG2"
names(cleanDF)
cleanDF[names(cleanDF) %in% "clutch.ID.G2"]
names(cleanDF) %in% "clutch.ID.G2"
cleanDF[!names(cleanDF) %in% "clutch.ID.G2"]
cleanDF <- cleanDF[!names(cleanDF) %in% "clutch.ID.G2"]
dataG1 <- read.csv("../../data/raw data Joshka Kostas/data-G1-Kostas_JK.csv")
dataAll <- read.csv("../../data/raw data Joshka Kostas/Kostas_G2_info.csv")
key <- read.csv("../../data/raw data Joshka Kostas/key_matchV48_clutchID_G2_Alice.csv")
as.character(dataG1$Idplate) %in% dataAll$matchV48
as.character(dataG1$Idplate)
dataAll$matchV48
dataG1$number.of.worms[is.na(dataG1$number.of.worms)] <- 0
cleanDF <- merge(data.frame(matchV48 = dataG1$Idplate,
FamilyOfFather = dataG1$FamilyOfFather,
clutch.ID = dataG1$clutch.ID,
HK.W = dataG1$HK.W/10,
No.Worms = dataG1$number.of.worms,
Wnettofin = dataG1$W.net,
Slfin = dataG1$SL),
dataAll,
all = TRUE)
cleanDF <- merge(data.frame(matchV48 = as.character(key$matchV48),
clutch.ID.G2 = key$clutch.ID),
cleanDF,
all=TRUE)
cleanDF$clutch.ID <- gsub("NA", "", paste0(cleanDF$clutch.ID, cleanDF$clutch.ID.G2))
cleanDF <- cleanDF[!names(cleanDF) %in% "clutch.ID.G2"]
cleanDF <- merge(na.omit(data.frame(FamilyOfFather = cleanDF$FamilyOfFather,
clutch.ID = cleanDF$clutch.ID,
fatherID = cleanDF$ID)),
cleanDF,
all = TRUE)
cleanDF <- cleanDF[!is.na(cleanDF$Generat),]
View(cleanDF)
merge(na.omit(data.frame(FamilyOfFather = cleanDF$FamilyOfFather,
clutch.ID = cleanDF$clutch.ID,
fatherID = cleanDF$ID)),
cleanDF,
all = TRUE)
dataG1 <- read.csv("../../data/raw data Joshka Kostas/data-G1-Kostas_JK.csv")
dataAll <- read.csv("../../data/raw data Joshka Kostas/Kostas_G2_info.csv")
key <- read.csv("../../data/raw data Joshka Kostas/key_matchV48_clutchID_G2_Alice.csv")
as.character(dataG1$Idplate) %in% dataAll$matchV48
as.character(dataG1$Idplate)
dataAll$matchV48
dataG1$number.of.worms[is.na(dataG1$number.of.worms)] <- 0
cleanDF <- merge(data.frame(matchV48 = dataG1$Idplate,
FamilyOfFather = dataG1$FamilyOfFather,
clutch.ID = dataG1$clutch.ID,
HK.W = dataG1$HK.W/10,
No.Worms = dataG1$number.of.worms,
Wnettofin = dataG1$W.net,
Slfin = dataG1$SL),
dataAll,
all = TRUE)
cleanDF <- merge(data.frame(matchV48 = as.character(key$matchV48),
clutch.ID.G2 = key$clutch.ID),
cleanDF,
all=TRUE)
cleanDF$clutch.ID <- gsub("NA", "", paste0(cleanDF$clutch.ID, cleanDF$clutch.ID.G2))
cleanDF <- cleanDF[!names(cleanDF) %in% "clutch.ID.G2"]
cleanDF <- merge(na.omit(data.frame(clutch.ID = cleanDF$clutch.ID,
fatherID = cleanDF$ID)),
cleanDF,
all = TRUE)
View(cleanDF)
dataG1 <- read.csv("../../data/raw data Joshka Kostas/data-G1-Kostas_JK.csv")
dataAll <- read.csv("../../data/raw data Joshka Kostas/Kostas_G2_info.csv")
key <- read.csv("../../data/raw data Joshka Kostas/key_matchV48_clutchID_G2_Alice.csv")
as.character(dataG1$Idplate) %in% dataAll$matchV48
as.character(dataG1$Idplate)
dataAll$matchV48
dataG1$number.of.worms[is.na(dataG1$number.of.worms)] <- 0
cleanDF <- merge(data.frame(matchV48 = dataG1$Idplate,
FamilyOfFather = dataG1$FamilyOfFather,
clutch.ID = dataG1$clutch.ID,
HK.W = dataG1$HK.W/10,
No.Worms = dataG1$number.of.worms,
Wnettofin = dataG1$W.net,
Slfin = dataG1$SL),
dataAll,
all = TRUE)
cleanDF <- merge(data.frame(matchV48 = as.character(key$matchV48),
clutch.ID.G2 = key$clutch.ID),
cleanDF,
all=TRUE)
cleanDF$clutch.ID <- gsub("NA", "", paste0(cleanDF$clutch.ID, cleanDF$clutch.ID.G2))
cleanDF <- cleanDF[!names(cleanDF) %in% "clutch.ID.G2"]
cleanDF <- merge(na.omit(data.frame(FamilyOfFather = cleanDF$FamilyOfFather,
clutch.ID = cleanDF$clutch.ID,
fatherID = cleanDF$ID)),
cleanDF,
all = TRUE)
cleanDF <- cleanDF[!is.na(cleanDF$Generat),]
View(cleanDF)
cleanDFG1 <- cleanDF[cleanDF$Generat %in% "P",]
cleanDFG2 <- cleanDF[cleanDF$Generat %in% "O",]
116+28
View(cleanDFG2)
View(cleanDFG1)
data.frame(FamilyOfFather = cleanDFG1$FamilyOfFather,
clutch.ID = cleanDFG1$clutch.ID,
fatherID = cleanDFG1$fatherID)
View(cleanDFG2)
merge(data.frame(FamilyOfFather = cleanDFG1$FamilyOfFather,
clutch.ID = cleanDFG1$clutch.ID,
fatherID = cleanDFG1$fatherID),
cleanDFG2)
merge(data.frame(FamilyOfFather = cleanDFG1$FamilyOfFather,
clutch.ID = cleanDFG1$clutch.ID,
fatherID = cleanDFG1$fatherID),
cleanDFG2, by=c("clutch.ID"))
cleanDFG2 <- merge(data.frame(FamilyOfFather = cleanDFG1$FamilyOfFather,
clutch.ID = cleanDFG1$clutch.ID,
fatherID = cleanDFG1$fatherID),
cleanDFG2, by=c("clutch.ID"))
View(cleanDFG2)
cleanDFG2 <- cleanDFG2[!names(cleanDFG2) %in% "FamilyOfFather.y", "fatherID.y")]
cleanDFG2 <- cleanDFG2[!names(cleanDFG2) %in% c("FamilyOfFather.y", "fatherID.y")]
names(cleanDFG2) %in% c("FamilyOfFather.x", "fatherID.x")
names(cleanDFG2)[names(cleanDFG2) %in% c("FamilyOfFather.x", "fatherID.x")]
names(cleanDFG2)[names(cleanDFG2) %in% c("FamilyOfFather.x", "fatherID.x")] <- c("FamilyOfFather", "fatherID")
rbind(cleanDFG1, cleanDFG2)
cleanDF <- rbind(cleanDFG1, cleanDFG2)
View(cleanDF)
cleanDF$fatherID[cleanDF$Generat %in% "P"]
cleanDF$fatherID[cleanDF$Generat %in% "P"] <- NA
dataG1 <- read.csv("../../data/raw data Joshka Kostas/data-G1-Kostas_JK.csv")
dataAll <- read.csv("../../data/raw data Joshka Kostas/Kostas_G2_info.csv")
key <- read.csv("../../data/raw data Joshka Kostas/key_matchV48_clutchID_G2_Alice.csv")
as.character(dataG1$Idplate) %in% dataAll$matchV48
as.character(dataG1$Idplate)
dataAll$matchV48
dataG1$number.of.worms[is.na(dataG1$number.of.worms)] <- 0
cleanDF <- merge(data.frame(matchV48 = dataG1$Idplate,
FamilyOfFather = dataG1$FamilyOfFather,
clutch.ID = dataG1$clutch.ID,
HK.W = dataG1$HK.W/10,
No.Worms = dataG1$number.of.worms,
Wnettofin = dataG1$W.net,
Slfin = dataG1$SL),
dataAll,
all = TRUE)
cleanDF <- merge(data.frame(matchV48 = as.character(key$matchV48),
clutch.ID.G2 = key$clutch.ID),
cleanDF,
all=TRUE)
cleanDF$clutch.ID <- gsub("NA", "", paste0(cleanDF$clutch.ID, cleanDF$clutch.ID.G2))
cleanDF <- cleanDF[!names(cleanDF) %in% "clutch.ID.G2"]
cleanDF <- merge(na.omit(data.frame(FamilyOfFather = cleanDF$FamilyOfFather,
clutch.ID = cleanDF$clutch.ID,
fatherID = cleanDF$ID)),
cleanDF,
all = TRUE)
cleanDF <- cleanDF[!is.na(cleanDF$Generat),]
cleanDFG1 <- cleanDF[cleanDF$Generat %in% "P",]
cleanDFG2 <- cleanDF[cleanDF$Generat %in% "O",]
cleanDFG2 <- merge(data.frame(FamilyOfFather = cleanDFG1$FamilyOfFather,
clutch.ID = cleanDFG1$clutch.ID,
fatherID = cleanDFG1$fatherID),
cleanDFG2, by=c("clutch.ID"))
cleanDFG2 <- cleanDFG2[!names(cleanDFG2) %in% c("FamilyOfFather.y", "fatherID.y")]
names(cleanDFG2)[names(cleanDFG2) %in% c("FamilyOfFather.x", "fatherID.x")] <- c("FamilyOfFather", "fatherID")
cleanDF <- rbind(cleanDFG1, cleanDFG2)
cleanDF$fatherID[cleanDF$Generat %in% "P"] <- NA
View(cleanDF)
write.csv(cleanDF, "../../data/cleanedRawData144fishG1G2.csv", quote = F, row.names = F)
Kostas <- read.csv("../../data/cleanedRawData144fishG1G2.csv")
Kostas$SampleID
Kostas$ID
Kostas$SampleID <- Kostas$ID
file <- read.csv("../../data/multiqc_general_stats_rawReads.txt")
file$SampleID = gsub("_L00.*","", gsub(".*-L1_","", file$Sample.Name))
names(file) <- c("Sample.Name", "percent_duplicates_rawReads", "percent_GC_rawReads", "M.Seqs_rawReads", "SampleID")
fileT <- read.table("../../data/multiqc_general_stats_trimmedReadsCutadapt.txt", header = T)
names(fileT) <- gsub("FastQC_mqc.generalstats.fastqc.", "", names(fileT))
fileT$SampleID = gsub("_L00.*","", gsub(".*-L1_","", fileT$Sample))
names(fileT) <- c("Sample", "percent_duplicates_trimmedReads", "percent_gc_trimmedReads", "avg_sequence_length_trimmedReads", "percent_fails_trimmedReads", "total_sequences_trimmedReads", "SampleID")
mappBismarck <- read.table(file = "../../data/Report_mapping_efficiency_Bismark.txt")
mappDatBIS <- data.frame(SampleID = gsub("_L00*.","", gsub(".*-L1_","", gsub("_R1_001_trimmed_cutadapt_bismark_bt2_SE_report.txt", "", mappBismarck$V1))),
MappingEfficiency = as.numeric(gsub("%", "", mappBismarck$V4)))
mappBSBolt <- read.table(file = "../../data/Report_mapping_efficiency_BSBolt.txt")
mappDatBSB <- data.frame(SampleID = gsub("_L00*.","", gsub(".*-L1_","", gsub("_R1_001_trimmed_cutadapt.fastq.gz", "", mappBSBolt$V1))),
MappingEfficiency = as.numeric(mappBSBolt$V3))
methylBSdf <- read.delim("/data/SBCS-EizaguirreLab/Alice/StickParaBroOff/Data/04BSBolt_methCall/BSBolt/MethylationCalling/Methylation_stats/nbrMethylatedCpGperSample.txt", header = FALSE)
names(methylBSdf) <- c("Sample_Name", "NbrMethylatedCpG")
methylBSdf$SampleID <- gsub("_L00*.","", gsub(".*-L1_","", gsub("_R1_001", "", methylBSdf$Sample_Name)))
